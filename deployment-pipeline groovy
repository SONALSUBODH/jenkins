pipeline {
    agent any
    stages {
        stage ('code-pull'){
            steps {
                git 'https://github.com/mayurmwagh/onlinebookstore.git'
            }
        }
        stage ('code-list'){
            steps {
               sh 'ls -lart'
            }
        }
        stage ('build'){
            steps {
                sh 'mvn clean package'
            }
        }
        stage ('Copy-Artifact'){
            steps {
                withCredentials([aws(accessKeyVariable: 'AWS_ACCESS_KEY_ID', credentialsId: 'aws_creds', secretKeyVariable: 'AWS_SECRET_ACCESS_KEY')]) {
                sh 'aws s3 ls'
                sh 'aws s3 cp /var/lib/jenkins/workspace/deploy/target/onlinebookstore.war s3://demostorebuildb20/'
                }
            }
        }
        
       
    }
}
